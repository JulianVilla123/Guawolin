{% extends 'partials/base.html' %}
{% block title %}Panel del Administrador{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto mt-10 px-4">
  <h2 class="text-3xl font-extrabold text-indigo-700 mb-8">‚öôÔ∏è Dashboard del administrador</h2>

  <!-- M√©tricas r√°pidas -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
    <div class="bg-white shadow-lg rounded-xl p-6 text-center">
      <h3 class="text-sm font-semibold text-gray-500">Usuarios registrados</h3>
      <p class="text-3xl font-bold text-indigo-600">{{ total_usuarios }}</p>
    </div>
    <div class="bg-white shadow-lg rounded-xl p-6 text-center">
      <h3 class="text-sm font-semibold text-gray-500">Eventos creados</h3>
      <p class="text-3xl font-bold text-yellow-500">{{ total_eventos }}</p>
    </div>
    <div class="bg-white shadow-lg rounded-xl p-6 text-center">
      <h3 class="text-sm font-semibold text-gray-500">Boletos vendidos</h3>
      <p class="text-3xl font-bold text-green-600">{{ boletos_vendidos }}</p>
    </div>
    <div class="bg-white shadow-lg rounded-xl p-6 text-center">
      <h3 class="text-sm font-semibold text-gray-500">Incidencias resueltas</h3>
      <p class="text-3xl font-bold text-red-600">{{ incidencias_resueltas }}</p>
    </div>
  </div>

<!-- Gr√°fica global compacta -->
<div class="bg-white shadow-lg rounded-xl p-6 w-full md:w-1/2 mx-auto">
  <h3 class="text-lg font-semibold text-gray-700 mb-4 text-center">Resumen global</h3>
  <div class="relative h-64">
    <canvas id="adminChart"></canvas>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('adminChart').getContext('2d');
  const adminChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Usuarios', 'Eventos', 'Boletos vendidos', 'Incidencias resueltas'],
      datasets: [{
        data: [
          {{ total_usuarios }},
          {{ total_eventos }},
          {{ boletos_vendidos }},
          {{ incidencias_resueltas }}
        ],
        backgroundColor: ['#6366F1', '#F59E0B', '#10B981', '#EF4444'],
        borderWidth: 2,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false, // üîë permite que se adapte al div contenedor
      plugins: {
        legend: {
          position: 'bottom',
          labels: { font: { size: 12 } }
        }
      }
    }
  });
</script>
</div>
{% endblock %}

