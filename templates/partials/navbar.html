{% load static %}
<nav class="bg-white shadow-md fixed w-full z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16 items-center">

      <!-- Logo -->
      <a href="{% url 'home' %}" class="text-2xl font-bold text-indigo-600 hover:text-indigo-800 transition">Fiestapp</a>

      <!-- Contenedor derecho -->
      <div class="flex items-center space-x-4 ml-auto">
        
        <!-- NavegaciÃ³n desktop -->
        <div class="hidden md:flex space-x-6 items-center">
          {% if not user.is_authenticated %}
            <a href="{% url 'como_usar' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Como Usar</a>
            <a href="{% url 'register_assistant' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Registro Asistentes</a>
            <a href="{% url 'register_organizer' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Organizador</a>
            <a href="{% url 'login' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Iniciar sesiÃ³n</a>
          {% elif user.rol == 'asistente' %}
            <a href="{% url 'panel_asistente' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Mi Panel</a>
            <a href="{% url 'eventos_disponibles' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Eventos</a>
            <a href="{% url 'mis_favoritos' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Favoritos</a>
            <a href="{% url 'mis_tickets' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Tickets</a>
          {% elif user.rol == 'organizador' %}
            <a href="{% url 'panel_organizador' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Mi Panel</a>
            <a href="{% url 'mis_eventos' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Mis Eventos</a>
            <a href="{% url 'crear_evento' %}" class="text-gray-700 hover:text-green-600 font-medium transition">Crear Evento</a>
          {% elif user.rol == 'administrador' %}
            <a href="{% url 'panel_administrador' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Panel Admin</a>
            <a href="{% url 'gestionar_usuarios' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Usuarios</a>
            <a href="{% url 'gestionar_eventos' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Eventos</a>
          {% elif user.rol == 'soporte' %}
            <a href="{% url 'panel_soporte' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Panel Soporte</a>
            <a href="{% url 'faq' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">FAQ</a>
          {% elif user.rol == 'desarrollador' %}
            <a href="{% url 'panel_desarrollador' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Panel Dev</a>
            <a href="{% url 'logs' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">Logs</a>
            <a href="{% url 'api_docs' %}" class="text-gray-700 hover:text-indigo-600 font-medium transition">API Docs</a>
          {% endif %}
        </div>

        <!-- Barra de bÃºsqueda desktop -->
        {% if user.is_authenticated and user.rol == 'organizador' or user.rol == 'asistente' or user.rol == 'administrador' or user.rol == 'soporte' or user.rol == 'desarrollador' %}
          <form method="get" action="{% url 'buscar_evento' %}" class="hidden md:flex items-center">
              {% csrf_token %}
            <input type="text" name="q" placeholder="Buscar evento..."
                  class="border rounded px-3 py-2 focus:outline-none focus:ring focus:border-indigo-300"/>
            <button type="submit" class="ml-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-800">
              Buscar
            </button>
          </form>
        {% endif %}

        <!-- BotÃ³n hamburguesa (solo mÃ³vil) -->
        <button class="md:hidden text-gray-700 focus:outline-none" onclick="toggleMobileMenu()">
          <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>

        <!-- Perfil desktop -->
        {% if user.is_authenticated %}
          <div class="relative">
            <button id="profileMenuBtn" class="w-9 h-9 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold focus:outline-none">
              {{ user.username|slice:":1"|upper }}
            </button>
            <div id="profileDropdown" class="hidden absolute top-full right-0 mt-2 w-56 bg-white border rounded shadow-lg z-50">
              <p class="px-4 py-2 text-gray-700 font-semibold">Hola, {{ user.username }}</p>
              <a href="{% url 'profile_settings' %}" class="block px-4 py-2 hover:bg-gray-100">âš™ï¸ ConfiguraciÃ³n</a>
              <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="w-full text-left px-4 py-2 hover:bg-gray-100 text-red-600">ğŸšª Cerrar sesiÃ³n</button>
              </form>
            </div>
          </div>
        {% endif %}
      </div>
    </div>
  </div>


  
  <!-- MenÃº mÃ³vil -->
  <div id="mobileMenu" class="md:hidden hidden bg-white shadow-lg px-4 pb-4 space-y-3 animate-slide-down">
    {% if user.is_authenticated %}
      <div class="flex items-center space-x-3 border-b pb-3">
        <div class="w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold">
          {{ user.username|slice:":1"|upper }}
        </div>
        <div class="flex-1">
          <p class="font-semibold text-gray-800 leading-tight">Hola, {{ user.username }}</p>
          <div class="flex gap-2 mt-1">
            <a href="{% url 'profile_settings' %}" class="px-3 py-1 text-sm bg-indigo-50 text-indigo-700 rounded hover:bg-indigo-100">ConfiguraciÃ³n</a>
            <form method="post" action="{% url 'logout' %}">
              {% csrf_token %}
              <button type="submit" class="px-3 py-1 text-sm bg-red-50 text-red-600 rounded hover:bg-red-100">Cerrar sesiÃ³n</button>
            </form>
          </div>
        </div>
      </div>
    {% endif %}

    {% if not user.is_authenticated %}
      <a href="{% url 'login' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ”‘ Iniciar sesiÃ³n</a>
      <a href="{% url 'register_assistant' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“ Registro Asistentes</a>
      <a href="{% url 'register_organizer' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ‘¤ Organizador</a>
    {% elif user.rol == 'asistente' %}
      <a href="{% url 'panel_asistente' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“‹ Mi Panel</a>
      <a href="{% url 'eventos_disponibles' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ‰ Eventos</a>
      <a href="{% url 'mis_favoritos' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">â­ Favoritos</a>
      <a href="{% url 'mis_tickets' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸŸï¸ Tickets</a>
    {% elif user.rol == 'organizador' %}
      <a href="{% url 'panel_organizador' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“‹ Mi Panel</a>
      <a href="{% url 'mis_eventos' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ‰ Mis Eventos</a>
      <a href="{% url 'crear_evento' %}" class="block px-2 py-2 rounded hover:bg-green-50 text-green-700">â• Crear Evento</a>
    {% elif user.rol == 'administrador' %}
      <a href="{% url 'panel_administrador' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“‹ Panel Admin</a>
      <a href="{% url 'gestionar_usuarios' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ‘¥ Usuarios</a>
      <a href="{% url 'gestionar_eventos' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ‰ Eventos</a>
    {% elif user.rol == 'soporte' %}
      <a href="{% url 'panel_soporte' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ› ï¸ Panel Soporte</a>
      <a href="{% url 'faq' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">â“ FAQ</a>
    {% elif user.rol == 'desarrollador' %}
      <a href="{% url 'panel_desarrollador' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ’» Panel Dev</a>
      <a href="{% url 'logs' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“œ Logs</a>
      <a href="{% url 'api_docs' %}" class="block px-2 py-2 rounded hover:bg-indigo-50">ğŸ“– API Docs</a>
        {% endif %}

    <!-- Barra de bÃºsqueda mÃ³vil -->
    {% if user.is_authenticated and user.rol == 'organizador' or user.rol == 'asistente' or user.rol == 'administrador' or user.rol == 'soporte' or user.rol == 'desarrollador' %}
      <form method="get" action="{% url 'buscar_evento' %}" class="flex items-center">
        {% csrf_token %}
        <input type="text" name="q" placeholder="Buscar evento..."
              class="border rounded px-3 py-2 focus:outline-none focus:ring focus:border-indigo-300"/>
        <button type="submit" class="ml-2 bg-indigo-600 text-white px-3 py-2 rounded hover:bg-indigo-800">
          Buscar
        </button>
      </form>
    {% endif %}



  </div>
</nav>

<script src="{% static 'JS/perfil.js' %}" defer></script>
<script>
function toggleMobileMenu() {
  document.getElementById("mobileMenu").classList.toggle("hidden");
}
</script>

<style>
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-slide-down {
  animation: slideDown 0.25s ease-out;
}
</style>